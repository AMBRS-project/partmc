
PartMC
======

PartMC - Particle-resolved Monte Carlo code for atmospheric aerosol simulation

Version 1.2.0  
Released 2009-02-17

<http://lagrange.mechse.uiuc.edu/mwest/partmc/>

Copyright (C) 2005-2009 Nicole Riemer and Matthew West  
Portions copyright (C) Andreas Bott and Richard Easter  
Licensed under the GNU General Public License version 2 or (at your
option) any later version.  
For details see the file COPYING or
<http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>.


Dependencies
============

Required dependencies:

   * Fortran 90 compiler
   * cmake version 2.6 or higher - <http://www.cmake.org/>
   * NetCDF - <http://www.unidata.ucar.edu/software/netcdf/>

Optional dependencies:

   * MOSAIC - Available from Rahul Zaveri - <Rahul.Zaveri@pnl.gov>

PartMC can be compiled out-of-the-box on Fedora 10 with all
dependencies except MOSAIC if the following packages are installed:

   * gcc-gfortran-4.3.2-7
   * cmake-2.6.2-3.fc10
   * netcdf-4.0.0-1.fc10


Installation
============

In principle PartMC should compile under any modern OS. Testing has
mainly been under Linux and OS X. The quick-start instructions under
Linux are:

1. Unpack PartMC with something like:
     tar xzvf partmc-1.2.0.tar.gz

2. Change into the main PartMC directory (where this README file is
   located) with something like:
     cd partmc-1.2.0

3. Make a directory called `build` and change into it:
     mkdir build
     cd build

4. Run cmake with (note the double-c):
     ccmake ..

5. Inside ccmake press `c`, edit the values as needed, press `c`
   again, then `g`.

6. Compile PartMC and test it as follows. Some tests may fail due to
   bad random initial conditions, so re-run the tests a few times to
   see if failures persist.
     make
     make test

7. To run just a single test do something like:
     ctest -R poisson # argument is a regexp for test names

8. To see what make is doing run it like this:
     VERBOSE=1 make

9. To run tests with visible output or to make some plots from the
   tests run them as:
     cd run_test/emission
     ./run_test_1.sh               # similary for other tests
     gnuplot plot_species.gnuplot  # etc...

10. There is a complete scenario run under the urban_plume/
    directory. From this directory do:
      ./run.sh
      gnuplot plot_aero_species_wc.gnuplot
      # similarly for other plots

The NetCDF libraries are required to compile PartMC. The `netcdf.mod`
Fortran 90 module file is required, and it must be produced by the
same compiler being used to compile PartMC.

PartMC can interface to the MOSAIC chemistry code (see above for
availability) but this is not enabled by default. To use MOSAIC, set
the `ENABLE_MOSAIC` variable to `ON` in cmake. The
`MOSAIC_INCLUDE_DIR` variable should be the location of the MOSAIC
module files (compiled with the same compiler), probably ending in
`mosaic/datamodules`. The `MOSAIC_LIB` variable should end in
something like `mosaic/libmosaic.a`.


Usage
=====

The main `partmc` command reads `.spec` files and does the run
specified therein. Either particle-resolved runs, sectional-code runs,
or exact solutions can be generated. A run produces one NetCDF file
per timestep, containing per-particle data (from particle-resolved
runs) or binned data (from sectional or exact runs). The extract_*
programs in the tool/ directory can read these per-timestep NetCDF
files and output ASCII data (the extract_sectional_* programs are used
for sectional and exact model output).


ChangeLog
=========

1.2.0 - XXXX-XX-XX

  * Output of full per-particle data in NetCDF format.

  * `urban_plume` test-case added, as described in the paper
    <http://arxiv.org/abs/0809.0875>

  * Build system switched to `cmake`.

  * Automated test suite added (`make test`).

1.1.0 - 2008-02-17

  * Internal reorganization to use Fortran 90 derived types for the
    data structures.

  * Integration with the MOSAIC gas- and aerosol-chemistry code.

  * Output is in binary NetCDF format.

  * Parallel implementation using 1D mixing.

1.0.0 - 2007-02-26

  * First release, including hierarchical coagulation and full water
    condensation.
